<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- App css -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <!-- <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> -->
    <link rel="stylesheet" href="style.css" />
    <title>Hello World ChartJs</title>
  </head>
  <body class="p-4 m-0">
    <div class="p-0 m-0">
      <!-- Quantity Detail -->
      <p class="fs-2">
        <a href="./dashboard.html" class="link">< </a> Machine Name
      </p>
      <div class="row p-0 m-0">
        <div class="col">
          <!-- Product Quantity  -->
          <div class="border border-white box-content row me-2 p-2">
            <canvas id="quantityChart" style="max-height: 150px"></canvas>
          </div>
          <div class="row">
            <div
              class="col box-content border border-white my-3 p-2 text-center"
            >
              <p class="fs-4">
                Good Parts <br />
                <span class="fw-bolder">2.7 K</span>
              </p>
            </div>
            <div
              class="col box-content border border-white m-3 p-2 text-center"
            >
              <p class="fs-4">
                Total Parts <br />
                <span class="fw-bolder">3.1 K</span>
              </p>
            </div>
          </div>
        </div>

        <!-- Production Rate -->
        <div class="col-4 p-3 mb-3 box-content border border-white">
          <p class="col-12 fs-3 mx-2">Production Rate</p>
          <canvas id="semiCircleChart" style="max-height: 150px"></canvas>
        </div>
      </div>

      <!-- Key Performance Indicators -->
      <div class="row p-0 m-0 box-content">
        <!-- OEE -->
        <div class="col my-auto">
          <canvas id="oeeChart"></canvas>
        </div>

        <!-- Availability -->
        <div class="col">
          <div class="">
            <canvas id="availabilityChart"></canvas>
          </div>
          <!-- availability table -->
          <div>
            <table class="table table-bordered">
              <thead class="thead-light">
                <tr>
                  <th>Availability</th>
                  <th>79.17 %</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Planned Runtime</td>
                  <td>480 minute</td>
                </tr>
                <tr>
                  <td>Actual Runtime</td>
                  <td>360 minute</td>
                </tr>
                <tr>
                  <td>Unplanned Downtime</td>
                  <td>0 minute</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Performance -->
        <div class="col">
          <div>
            <p>perf graph</p>
          </div>
          <!-- performance table -->
          <div>
            <table class="table table-bordered">
              <thead class="thead-light">
                <tr>
                  <th>Performance</th>
                  <th>42.06 %</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Planned Quantity</td>
                  <td>1000 parts</td>
                </tr>
                <tr>
                  <td>Actual Quantity</td>
                  <td>900 parts</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Quality -->
        <div class="col">
          <div>
            <p>quality</p>
          </div>
          <!-- quality table -->
          <div>
            <table class="table table-bordered">
              <thead class="thead-light">
                <tr>
                  <th>Quality</th>
                  <th>100 %</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>actual Quantity</td>
                  <td>900 parts</td>
                </tr>
                <tr>
                  <td>Reject Quantity</td>
                  <td>0 parts</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script>
      var socket = io();
      socket.on("test", (data) => {
        console.log(data);
      });

      // socket.on("machineDetail", (data) => {
      //   console.log(data);
      // });
    let machineId = window.localStorage.getItem("machineId");
    console.log(machineId)
    
      socket.emit("sendMachineId", (machineId) => {    
        console.log(machineId);
      });

      socket.on("machineDetail", (data) => {
        console.log(data);

        // horizontal bar chart
        let qtChart = document.getElementById("quantityChart").getContext("2d");
        let quantityChart = new Chart(qtChart, {
          data: {
            labels: ["", "Product Quantity", ""],
            datasets: [
              {
                type: "bar",
                axis: "x",
                data: [0, 50, 0, 100],
                fill: false,
                backgroundColor: "#74c69d",
                borderColor: "#777",
                borderWidth: 1,
              },
              {
                type: "line",
                label: "Expected Quantity",
                data: [58, 58, 58],
                fill: false,
                borderColor: "rgb(54, 162, 235)",
                pointStyle: "circle",
              },
            ],
          },
          options: {
            color: "#f2e8cf",
            indexAxis: "y",
            // labels:{
            //   fontColor : "#f2e8cf",
            // }
          },
        });

        // OEE-doughnut chart
        let dnChart = document.getElementById("oeeChart").getContext("2d");
        let oeeDn = new Chart(dnChart, {
          type: "doughnut",
          data: {
            datasets: [
              {
                label: "OEE",
                data: [86, 14],
                backgroundColor: ["#74c69d", "#f2e8cf"],
                borderWidth: 1,
                borderColor: "#777",
                hoverBorderWidth: 3,
                hoverBorderColor: "#000",
              },
            ],
          },
          options: {
            title: {
              display: true,
              text: "OEE",
              fontSize: 25,
            },
            legend: {
              display: true,
              position: "right",
            },
            layout: {
              padding: {
                left: 50,
                right: 0,
                top: 0,
                bottom: 0,
              },
            },
          },
        });

        // availability-doughnut chart
        let availabilityChart = document
          .getElementById("availabilityChart")
          .getContext("2d");
        let availabilityDn = new Chart(availabilityChart, {
          type: "doughnut",
          data: {
            datasets: [
              {
                label: "OEE",
                data: [86, 14],
                backgroundColor: ["#74c69d", "#f2e8cf"],
                borderWidth: 1,
                borderColor: "#777",
                hoverBorderWidth: 3,
                hoverBorderColor: "#000",
              },
            ],
          },
          options: {
            title: {
              display: true,
              text: "OEE",
              fontSize: 25,
            },
            legend: {
              display: true,
              position: "right",
            },
            layout: {
              padding: {
                left: 50,
                right: 0,
                top: 0,
                bottom: 0,
              },
            },
          },
        });
        //  semi circle chart
        let scChart = document
          .getElementById("semiCircleChart")
          .getContext("2d");
        let semiCirlceChart = new Chart(scChart, {
          type: "doughnut",
          data: {
            datasets: [
              {
                label: "OEE",
                data: [86, 14],
                backgroundColor: ["#74c69d", "#f2e8cf"],
                borderWidth: 1,
                borderColor: "#777",
                hoverBorderWidth: 3,
                hoverBorderColor: "#000",
              },
            ],
          },
          options: {
            rotation: -90,
            circumference: 180,
            cutout: "70%",
            title: {
              display: false,
            },
            legend: {
              display: true,
              position: "right",
            },
            layout: {
              padding: {
                left: 50,
                right: 0,
                top: 0,
                bottom: 0,
              },
            },
          },
        });
      });
    </script>
  </body>
</html>
